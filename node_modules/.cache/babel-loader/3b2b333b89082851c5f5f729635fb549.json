{"ast":null,"code":"import Api from 'Api/api';\nimport { call, put, take } from 'redux-saga/effects';\nimport { REGISTER_REQUEST } from 'store/actionTypes/registerActionType';\nimport { message } from 'antd';\nimport { loginSuccess, saveToken, loginError } from 'store/actions';\nimport { LOGIN_SUCCESS, LOGIN_ERROR } from 'store/actionTypes';\nexport function fakeAutoRise(email, password, fullName, companyName) {\n  return new Promise(async (resolve, reject) => {\n    let headerConfig = {\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    };\n\n    try {\n      const result = await Api.post('company/register', {\n        email: email,\n        password: password,\n        fullname: fullName,\n        companyName: companyName\n      }, headerConfig).catch(error => {\n        if (error.response.status === 400) {\n          message.error('حسابی با این ایمیل یا شرکت قبلا ثبت شده است');\n        } else {\n          message.error('لطفا وضعیت اتصال به اینترنت را بررسی نمایید');\n        }\n\n        reject(error);\n      }).then(response => {\n        window.localStorage.removeItem('accessToken');\n        window.localStorage.removeItem('refreshToken');\n        window.localStorage.setItem('accessToken', response.data.accessToken);\n        window.localStorage.setItem('refreshToken', response.data.refreshToken);\n        resolve(response.data.accessToken);\n      });\n    } catch (e) {\n      reject(e);\n    }\n  });\n}\nexport function deleteToken() {\n  return new Promise(async (resolve, reject) => {\n    try {\n      window.localStorage.setItem('accessToken', '');\n      resolve('');\n    } catch (e) {\n      reject(e);\n    }\n  });\n}\nexport function* autorize(email, password, fullName, companyName) {\n  try {\n    const token = yield call(fakeAutoRise, email, password, fullName, companyName);\n    yield put(loginSuccess(LOGIN_SUCCESS)); //@ts-ignore\n\n    yield put(saveToken(token, localStorage.getItem('refreshToken')));\n  } catch (error) {\n    yield put(loginError(LOGIN_ERROR));\n  }\n}\nexport function* registerFlow() {\n  while (true) {\n    const _ref = yield take(REGISTER_REQUEST),\n          email = _ref.email,\n          password = _ref.password,\n          fullname = _ref.fullname,\n          companyName = _ref.companyName;\n\n    yield call(autorize, email, password, fullname, companyName);\n  }\n}","map":{"version":3,"sources":["/home/rasoolhp/Desktop/profile-job/Profile-Jobs-Front/src/store/sagas/registerSaga.tsx"],"names":["Api","call","put","take","REGISTER_REQUEST","message","loginSuccess","saveToken","loginError","LOGIN_SUCCESS","LOGIN_ERROR","fakeAutoRise","email","password","fullName","companyName","Promise","resolve","reject","headerConfig","headers","result","post","fullname","catch","error","response","status","then","window","localStorage","removeItem","setItem","data","accessToken","refreshToken","e","deleteToken","autorize","token","getItem","registerFlow"],"mappings":"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","sourcesContent":["import Api from 'Api/api';\nimport { call, put, take } from 'redux-saga/effects';\nimport {\n  REGISTER_REQUEST,\n  REGISTER_SUCCESS,\n  REGISTER_ERROR,\n} from 'store/actionTypes/registerActionType';\nimport {\n  registerSuccess,\n  registerError,\n  saveRegisterToken,\n} from 'store/actions/registerActions';\nimport { message } from 'antd';\nimport { loginSuccess, saveToken, loginError } from 'store/actions';\nimport { LOGIN_SUCCESS, LOGIN_ERROR } from 'store/actionTypes';\n\nexport function fakeAutoRise(\n  email: string,\n  password: string,\n  fullName: string,\n  companyName: string,\n) {\n  return new Promise(async (resolve, reject) => {\n    let headerConfig = {\n      headers: {\n        'Content-Type': 'application/json',\n      },\n    };\n\n    try {\n      const result = await Api.post(\n        'company/register',\n        {\n          email: email,\n          password: password,\n          fullname: fullName,\n          companyName: companyName,\n        },\n        headerConfig,\n      )\n        .catch((error: any) => {\n          if (error.response.status === 400) {\n            message.error('حسابی با این ایمیل یا شرکت قبلا ثبت شده است');\n          } else {\n            message.error('لطفا وضعیت اتصال به اینترنت را بررسی نمایید');\n          }\n          reject(error);\n        })\n        .then((response: any) => {\n          window.localStorage.removeItem('accessToken');\n          window.localStorage.removeItem('refreshToken');\n          window.localStorage.setItem('accessToken', response.data.accessToken);\n          window.localStorage.setItem(\n            'refreshToken',\n            response.data.refreshToken,\n          );\n          resolve(response.data.accessToken);\n        });\n    } catch (e) {\n      reject(e);\n    }\n  });\n}\n\nexport function deleteToken() {\n  return new Promise(async (resolve, reject) => {\n    try {\n      window.localStorage.setItem('accessToken', '');\n      resolve('');\n    } catch (e) {\n      reject(e);\n    }\n  });\n}\n\nexport function* autorize(\n  email: string,\n  password: string,\n  fullName: string,\n  companyName: string,\n) {\n  try {\n    const token = yield call(\n      fakeAutoRise,\n      email,\n      password,\n      fullName,\n      companyName,\n    );\n    yield put(loginSuccess(LOGIN_SUCCESS));\n    //@ts-ignore\n    yield put(saveToken(token, localStorage.getItem('refreshToken')));\n  } catch (error) {\n    yield put(loginError(LOGIN_ERROR));\n  }\n}\n\nexport function* registerFlow() {\n  while (true) {\n    const { email, password, fullname, companyName } = yield take(\n      REGISTER_REQUEST,\n    );\n\n    yield call(autorize, email, password, fullname, companyName);\n  }\n}\n"]},"metadata":{},"sourceType":"module"}